<!DOCTYPE html>
<html lang=en>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="ä½œä¸šçš„è¿è¡Œç¯å¢ƒæˆ‘é€‰æ‹©ã€ŒWorking locallyã€ã€‚åœ¨é…ç½®è™šæ‹Ÿç¯å¢ƒè¿‡ç¨‹ä¸­ï¼ŒæœçœŸé‡åˆ° matplotlib è¿è¡Œä¸äº†çš„é—®é¢˜ï¼Œå‚è€ƒ Working with Matplotlib on OSXï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼Œå‡ ä¹æ¯ç§æ–¹æ³•è®¾ç½®ä¸€éï¼Œé‡å¯äº†å¥½å‡ æ¬¡è™šæ‹Ÿç¯å¢ƒï¼Œæœ€åå¯ä»¥ç”¨ jupyter notebook æ‰“å¼€ã€‚ k-Nearest Neighbor (kNN) exerciseç‚¹å‡»ã€Œrunã€æ‰§è¡Œæ¯ä¸ªæ¡†æ¡†ï¼Œ">
<meta property="og:type" content="article">
<meta property="og:title" content="cs231n assignment1 å­¦ä¹ ç¬”è®°">
<meta property="og:url" content="http://yoursite.com/2017/11/10/cs231n-assignment1/index.html">
<meta property="og:site_name" content="Colorjam">
<meta property="og:description" content="ä½œä¸šçš„è¿è¡Œç¯å¢ƒæˆ‘é€‰æ‹©ã€ŒWorking locallyã€ã€‚åœ¨é…ç½®è™šæ‹Ÿç¯å¢ƒè¿‡ç¨‹ä¸­ï¼ŒæœçœŸé‡åˆ° matplotlib è¿è¡Œä¸äº†çš„é—®é¢˜ï¼Œå‚è€ƒ Working with Matplotlib on OSXï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼Œå‡ ä¹æ¯ç§æ–¹æ³•è®¾ç½®ä¸€éï¼Œé‡å¯äº†å¥½å‡ æ¬¡è™šæ‹Ÿç¯å¢ƒï¼Œæœ€åå¯ä»¥ç”¨ jupyter notebook æ‰“å¼€ã€‚ k-Nearest Neighbor (kNN) exerciseç‚¹å‡»ã€Œrunã€æ‰§è¡Œæ¯ä¸ªæ¡†æ¡†ï¼Œ">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/knn.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/svm_dw.jpg">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/plot_loss.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/plot_weights1.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/plot_loss2.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/plot_weights2.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/softmax_loss.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/probability.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/hs300.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/change_hs.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/learning_rate_error.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/change_lr1.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/change_lr2.png">
<meta property="og:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/change_hs_rg.png">
<meta property="og:updated_time" content="2017-12-10T09:53:16.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="cs231n assignment1 å­¦ä¹ ç¬”è®°">
<meta name="twitter:description" content="ä½œä¸šçš„è¿è¡Œç¯å¢ƒæˆ‘é€‰æ‹©ã€ŒWorking locallyã€ã€‚åœ¨é…ç½®è™šæ‹Ÿç¯å¢ƒè¿‡ç¨‹ä¸­ï¼ŒæœçœŸé‡åˆ° matplotlib è¿è¡Œä¸äº†çš„é—®é¢˜ï¼Œå‚è€ƒ Working with Matplotlib on OSXï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼Œå‡ ä¹æ¯ç§æ–¹æ³•è®¾ç½®ä¸€éï¼Œé‡å¯äº†å¥½å‡ æ¬¡è™šæ‹Ÿç¯å¢ƒï¼Œæœ€åå¯ä»¥ç”¨ jupyter notebook æ‰“å¼€ã€‚ k-Nearest Neighbor (kNN) exerciseç‚¹å‡»ã€Œrunã€æ‰§è¡Œæ¯ä¸ªæ¡†æ¡†ï¼Œ">
<meta name="twitter:image" content="http://yoursite.com/2017/11/10/cs231n-assignment1/knn.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>cs231n assignment1 å­¦ä¹ ç¬”è®°</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
    
</head>


<div id="particles-js"></div>
<body class="max-width mx-auto px3 ltr">    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/01/19/FullyConnectedNets-train/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2017/11/05/machine-learning-in-action-note5/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2017/11/10/cs231n-assignment1/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&text=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&title=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&is_video=false&description=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=cs231n assignment1 å­¦ä¹ ç¬”è®°&body=Check out this article: http://yoursite.com/2017/11/10/cs231n-assignment1/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&title=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&title=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&title=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&title=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&name=cs231n assignment1 å­¦ä¹ ç¬”è®°&description=&lt;p&gt;ä½œä¸šçš„è¿è¡Œç¯å¢ƒæˆ‘é€‰æ‹©ã€ŒWorking locallyã€ã€‚åœ¨é…ç½®è™šæ‹Ÿç¯å¢ƒè¿‡ç¨‹ä¸­ï¼ŒæœçœŸé‡åˆ° matplotlib è¿è¡Œä¸äº†çš„é—®é¢˜ï¼Œå‚è€ƒ &lt;a href=&#34;https://matplotlib.org/faq/osx_framework.html#osxframework-faq&#34; target=&#34;_blank&#34; rel=&#34;external&#34;&gt;Working with Matplotlib on OSX&lt;/a&gt;ï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼Œå‡ ä¹æ¯ç§æ–¹æ³•è®¾ç½®ä¸€éï¼Œé‡å¯äº†å¥½å‡ æ¬¡è™šæ‹Ÿç¯å¢ƒï¼Œæœ€åå¯ä»¥ç”¨ jupyter notebook æ‰“å¼€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;k-Nearest-Neighbor-kNN-exercise&#34;&gt;&lt;a href=&#34;#k-Nearest-Neighbor-kNN-exercise&#34; class=&#34;headerlink&#34; title=&#34;k-Nearest Neighbor (kNN) exercise&#34;&gt;&lt;/a&gt;k-Nearest Neighbor (kNN) exercise&lt;/h3&gt;&lt;p&gt;ç‚¹å‡»ã€Œrunã€æ‰§è¡Œæ¯ä¸ªæ¡†æ¡†ï¼Œ&lt;code&gt;dists = classifier.compute_distances_two_loops(X_test)&lt;/code&gt; çœŸçš„è¦è¿è¡Œéå¸¸éå¸¸éå¸¸ä¹…ï¼ŒåŒæ—¶æ¡†æ¡†å·¦è¾¹ä¼šå·¦è¾¹å˜æˆ In [*]ï¼Œç„¶åæˆ‘å‚»å‚»çš„ä»¥ä¸ºå¡äº†ï¼Œé‡å¯äº†å¥½å¤šæ¬¡ï¼Œåæ¥æ‰é†’æ‚Ÿè¿™æ˜¯æ­£åœ¨è¿è¡Œçš„æ„æ€ã€‚&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#k-Nearest-Neighbor-kNN-exercise"><span class="toc-number">1.</span> <span class="toc-text">k-Nearest Neighbor (kNN) exercise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Multiclass-Support-Vector-Machine-exercise"><span class="toc-number">2.</span> <span class="toc-text">Multiclass Support Vector Machine exercise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Softmax-exercise"><span class="toc-number">3.</span> <span class="toc-text">Softmax exercise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Implementing-a-Neural-Network"><span class="toc-number">4.</span> <span class="toc-text">Implementing a Neural Network</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        cs231n assignment1 å­¦ä¹ ç¬”è®°
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Colorjam</span>
      </span>
      
    <div class="postdate">
        <time datetime="2017-11-10T13:43:02.000Z" itemprop="datePublished">2017-11-10</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>ä½œä¸šçš„è¿è¡Œç¯å¢ƒæˆ‘é€‰æ‹©ã€ŒWorking locallyã€ã€‚åœ¨é…ç½®è™šæ‹Ÿç¯å¢ƒè¿‡ç¨‹ä¸­ï¼ŒæœçœŸé‡åˆ° matplotlib è¿è¡Œä¸äº†çš„é—®é¢˜ï¼Œå‚è€ƒ <a href="https://matplotlib.org/faq/osx_framework.html#osxframework-faq" target="_blank" rel="external">Working with Matplotlib on OSX</a>ï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼Œå‡ ä¹æ¯ç§æ–¹æ³•è®¾ç½®ä¸€éï¼Œé‡å¯äº†å¥½å‡ æ¬¡è™šæ‹Ÿç¯å¢ƒï¼Œæœ€åå¯ä»¥ç”¨ jupyter notebook æ‰“å¼€ã€‚</p>
<h3 id="k-Nearest-Neighbor-kNN-exercise"><a href="#k-Nearest-Neighbor-kNN-exercise" class="headerlink" title="k-Nearest Neighbor (kNN) exercise"></a>k-Nearest Neighbor (kNN) exercise</h3><p>ç‚¹å‡»ã€Œrunã€æ‰§è¡Œæ¯ä¸ªæ¡†æ¡†ï¼Œ<code>dists = classifier.compute_distances_two_loops(X_test)</code> çœŸçš„è¦è¿è¡Œéå¸¸éå¸¸éå¸¸ä¹…ï¼ŒåŒæ—¶æ¡†æ¡†å·¦è¾¹ä¼šå·¦è¾¹å˜æˆ In [*]ï¼Œç„¶åæˆ‘å‚»å‚»çš„ä»¥ä¸ºå¡äº†ï¼Œé‡å¯äº†å¥½å¤šæ¬¡ï¼Œåæ¥æ‰é†’æ‚Ÿè¿™æ˜¯æ­£åœ¨è¿è¡Œçš„æ„æ€ã€‚</p>
<a id="more"></a>
<p>è¿›è¡Œé¢„æµ‹çš„æ—¶å€™å‘ç°å‡†ç¡®åº¦æ— è®ºå¦‚ä½•éƒ½æ˜¯0.14ï¼ŒæŸ¥äº†ä¸€ä¸‹å‘ç° <code>predict_labels</code> å‡½æ•°æ²¡æœ‰ä¿®æ”¹ğŸ˜‚ </p>
<p>äºŒæ¬¡å¾ªç¯çš„å‡½æ•°æ¯”è¾ƒç®€å•ï¼Œä¸€æ¬¡å¾ªç¯è¾¹æ´—æ¾¡è¾¹æ€è€ƒï¼Œç„¶åå¤´è„‘é£æš´çŸ©é˜µå˜æ¢ï¼Œå¼€å¿ƒåœ°æƒ³å‡ºæ¥äº†â˜ºï¸ æ ¸å¿ƒä»£ç <code>dists[i, :] = np.sqrt(np.sum((X[i, :] - self.X_train) ** 2, axis = 1)).T</code></p>
<p>æ— å¾ªç¯å‡½æ•°ä¼°æ‘¸ç€åº”è¯¥æ˜¯è¦è¿ç”¨æ•°å­¦å…¬å¼æ¥è§£å†³ã€‚å‡è®¾æµ‹è¯•é›†(2x3)ï¼š<br>$$<br>testX = \begin{pmatrix} x_{11}&amp;x_{12}&amp;x_{13} \\x_{21}&amp;x_{22}&amp;x_{23} \end{pmatrix}<br>$$<br>è®­ç»ƒé›†(4x3)ï¼š<br>$$<br>trainX = \begin{pmatrix}y_{11}&amp;y_{12}&amp;y_{13} \\y_{21}&amp;y_{22}&amp;y_{23}\\y_{31}&amp;y_{32}&amp;y_{33}\\y_{41}&amp;y_{42}&amp;y_{43}\ \end{pmatrix}<br>$$<br>æœ€åç”Ÿæˆ dist (2x4) çš„è·ç¦»çŸ©é˜µï¼Œè‡ªç„¶è”æƒ³åˆ°çŸ©é˜µä¹˜æ³• (2x4) := (2x3) x (3x4)ã€‚åˆšå¥½ä»£ç ä¸­ä¹Ÿæœ‰æç¤ºçŸ©é˜µä¹˜æ³•ï¼Œé‚£ä¹ˆ \(trainX\) å¿…ç„¶æ˜¯è½¬ç½®ä¸€ä¸‹çš„ã€‚<br>$$<br>trainX^T = \begin{pmatrix}y_{11}&amp;y_{21}&amp;y_{31}&amp;y_{41} \\y_{12}&amp;y_{22}&amp;y_{32}&amp;y_{42}\\y_{13}&amp;y_{23}&amp;y_{33}&amp;y_{43}\\ \end{pmatrix}<br>$$<br>æˆ‘ä»¬å–å‡ºä¸€ä¸ªæµ‹è¯•é›†å’Œä¸€ä¸ªè®­ç»ƒé›†ï¼Œè®¡ç®—ä¸€ä¸‹å®ƒä»¬çš„æ¬§æ°è·ç¦»ï¼š<br>$$<br>dist[1, 1] = \sqrt{(x_{11}-y_{11})^2 + (x_{12}-y_{12})^2 + (x_{13}-y_{13})^2 }<br>$$<br>æˆ‘ä»¬è¯•ä¸€ä¸‹æŠŠæ¯ä¸ªå¹³æ–¹æ‹†å¼€ï¼š<br>$$<br>dist[1, 1] = \sqrt{x_{11}^2 - 2x_{11}y_{11}+y_{11}^2 + x_{12}^2 - 2x_{12}y_{12}+y_{12}^2+x_{13}^2 - 2x_{13}y_{13}+y_{13}^2}<br>$$<br>æ•´ç†å‡ºæ ¹å·é‡Œå¤´çš„å®¶ä¼™ï¼š<br>$$<br>x_{11}^2+ x_{12}^2+x_{13}^2 +y_{11}^2+y_{12}^2 +y_{13}^2 - 2(x_{11}y_{11}   +x_{12}y_{12}+ x_{13}y_{13})<br>$$<br>å—¯ã€‚ã€‚ã€‚å†ä¸€æ¬¡æ„Ÿå¹æ•°å­¦ä¹‹ç¾ã€‚ã€‚ã€‚äºæ˜¯ã€Œæ ¹å·é‡Œå¤´çš„å®¶ä¼™ã€å°±è¢«åˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†</p>
<ul>
<li>\(x_{11}^2+ x_{12}^2 +x_{13}^2\) ç›¸å½“äº \(testX\) å…ƒç´ å¹³æ–¹ï¼Œå†æŒ‰åˆ—ç›¸åŠ ï¼Œå³æŠŠçŸ©é˜µå‹ç¼©æˆä¸€åˆ—ã€‚</li>
<li>\(y_{11}^2+y_{12}^2 +y_{13}^2\) ç›¸å½“äº \(trainX^T\) å…ƒç´ å¹³æ–¹ï¼Œå†æŒ‰è¡Œç›¸åŠ  ï¼Œå³æŠŠçŸ©é˜µå‹ç¼©æˆä¸€è¡Œã€‚</li>
<li>\(x_{11}y_{11}   +x_{12}y_{12}+ x_{13}y_{13}\) ç›¸å½“äº\(testX * trainX\)</li>
</ul>
<p>äºæ˜¯å°±å¯ä»¥<strong>broadcasting</strong>å•¦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">transXtrain = self.X_train.T <span class="comment"># è½¬ç½®è®­ç»ƒé›†</span></div><div class="line">sumX = np.sum(X ** <span class="number">2</span>, axis = <span class="number">1</span>)[:, np.newaxis] <span class="comment">#ï¼ˆ500x1ï¼‰</span></div><div class="line">sumtransXtrain = np.sum(transXtrain ** <span class="number">2</span>, axis = <span class="number">0</span>)[np.newaxis] <span class="comment">#ï¼ˆ1x5000ï¼‰</span></div><div class="line">dists = np.sqrt( sumX + sumtransXtrain - <span class="number">2</span> * np.dot(X, transXtrain)) <span class="comment"># broadcasting &amp; matrix multiplication</span></div></pre></td></tr></table></figure>
<p>æœ€åä¸€ä¸ªéƒ¨åˆ†æ˜¯å…³äºk-æŠ˜äº¤å‰éªŒè¯ï¼Œæ ¹æ®ä½œä¸šæç¤ºï¼Œå¾ªç¯æ¯ä¸ªå¯èƒ½çš„kå€¼ï¼Œè¿è¡Œk-nnç®—æ³• num_folds æ¬¡ï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªå­é›†ä½œä¸ºè®­ç»ƒé›†ï¼Œæœ€åä¸€ä¸ªå­é›†ä¸ºéªŒè¯é›†ã€‚ä½†å‚è€ƒäº†ç½‘ä¸Šå…³äº10æŠ˜äº¤å‰éªŒè¯çš„è¯´æ³•ï¼Œæ˜¯è½®æµå°†å…¶ä¸­9ä»½ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œ1ä»½ä½œä¸ºæµ‹è¯•æ•°æ®çš„ã€‚æ‰€ä»¥æˆ‘å°±å¾ªç¯äº†num+folds-1æ¬¡ã€‚ï¼ˆååˆå‚è€ƒç½‘ä¸Šå…¶ä»–å®ç°ä»£ç ï¼Œå‘ç°åº”è¯¥é€‰æ‹©ä¸€ä¸ªè‡ªå·±ä½œä¸ºéªŒè¯é›†ï¼Œå…¶ä»–æ‰€æœ‰è‡ªå·±åˆå¹¶ä½œä¸ºè®­ç»ƒé›†ã€‚ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">size = X_train_folds[<span class="number">0</span>].shape[<span class="number">0</span>]</div><div class="line"><span class="keyword">for</span> k <span class="keyword">in</span> k_choices:</div><div class="line">    k_to_accuracies[k] = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(num_folds<span class="number">-1</span>): <span class="comment"># each case </span></div><div class="line">        classifier.train(X_train_folds[i], y_train_folds[i]) <span class="comment"># use one as training data</span></div><div class="line">        predict_labels = classifier.predict(X_train_folds[<span class="number">-1</span>], k, num_loops = <span class="number">0</span>)</div><div class="line">        accuracy = sum(predict_labels == y_train_folds[<span class="number">-1</span>]) / size <span class="comment"># last fold as validation set</span></div><div class="line">        k_to_accuracies[k].append(accuracy)</div></pre></td></tr></table></figure>
<p><img src="/2017/11/10/cs231n-assignment1/knn.png" alt="cross-validation"></p>
<p>æœ€åæ ¹æ®äº¤å‰éªŒè¯çš„ç»“æœé€‰æ‹©k=8æœ€ä½³ã€‚</p>
<h3 id="Multiclass-Support-Vector-Machine-exercise"><a href="#Multiclass-Support-Vector-Machine-exercise" class="headerlink" title="Multiclass Support Vector Machine exercise"></a>Multiclass Support Vector Machine exercise</h3><p>åœ¨ç¬¬ä¸€éƒ¨åˆ†è¡¥å……dWå°±å¡äº†è¶…çº§ä¹…ã€‚ã€‚ã€‚é¦–å…ˆè¦å…ˆçœ‹å®˜æ–¹çš„è¯¾ç¨‹ç¬”è®° <a href="http://cs231n.github.io/optimization-1/#opt3" target="_blank" rel="external">optimization-1</a> ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨å¾®ç§¯åˆ†æ¥è®¡ç®—dWã€‚å½“ $j = y_j $æ—¶å…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\nabla_{w_{y_i}} L_i = - \left( \sum_{j\neq y_i} ğŸ™(w_j^Tx_i - w_{y_i}^Tx_i + \Delta &gt; 0) \right) x_i<br>$$<br>ä»£è¡¨æ¢¯åº¦å‡å°‘ margin &gt; 0 çš„ä¸ªæ•°ä¹˜ä»¥æ ·æœ¬ã€‚</p>
<p>å½“ $ j  \neq y_j $æ—¶ï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\nabla_{w_j} L_i = \ ğŸ™(w_j^Tx_i - w_{y_i}^Tx_i + \Delta &gt; 0) x_i<br>$$<br>é¦–å…ˆæ˜¯å®ç”¨å¾ªç¯æ–¹å¼çš„å‡½æ•°ã€‚ä¸€å¼€å§‹æˆ‘æƒ³ç€é‚£å°±ç”¨å½“ margin &gt; 0 æ—¶è®¾ç½®ä¸€ä¸ªcntæ¥è¿›è¡Œè®¡æ•°ï¼Œç„¶åè¿˜å¼„äº†ä¸€ä¸ªéå¸¸éº»çƒ¦çš„ tile</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">correct_j = <span class="number">0</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(num_train):</div><div class="line">  cnt = <span class="number">0</span></div><div class="line">  scores = X[i].dot(W) <span class="comment"># (1, C)</span></div><div class="line">  correct_class_score = scores[y[i]]</div><div class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> xrange(num_classes):</div><div class="line">    <span class="keyword">if</span> j == y[i]:</div><div class="line">      correct_j = j</div><div class="line">      <span class="keyword">continue</span></div><div class="line">      margin = scores[j] - correct_class_score + <span class="number">1</span> <span class="comment"># note delta = 1</span></div><div class="line">      <span class="keyword">if</span> margin &gt; <span class="number">0</span>:</div><div class="line">        loss += margin</div><div class="line">        cnt += <span class="number">1</span></div><div class="line">        </div><div class="line">  dW_test = np.tile(X[i].T[:,np.newaxis],(<span class="number">1</span>, num_classes)) <span class="comment"># é”™çš„é”™çš„</span></div><div class="line">  dW_test[:, correct_j] =  cnt * X[i].T</div></pre></td></tr></table></figure>
<p>åœ¨å®åœ¨æƒ³ä¸å‡ºæ¥çš„æƒ…å†µä¸‹ï¼Œå·å·æ‰¾äº†ä¸€ä¸‹å…¶ä»–åŒå­¦çš„ä»£ç ï¼Œå‘ç°å…¶å®åªè¦éå¸¸ç®€å•çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> margin &gt; <span class="number">0</span>:</div><div class="line">	loss += margin</div><div class="line">    dW[:, j] += X[i].T</div><div class="line">    dW[:, y[i]] -= X[i].T</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæ„è¯†åˆ°äº†è‡ªå·±ä»£ç çš„ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li><p>åå¯¼éƒ½æ˜¯ç´¯ç§¯çš„è¿‡ç¨‹ä¹Ÿå°±æ˜¯è¯´ä¸­é—´çš„ç¬¦å·æ˜¯ += æˆ–è€… -= </p>
</li>
<li><p>å½“ $ j \neq y_j $ æ—¶ï¼ŒdWåªæœ‰ç›¸åº”çš„ j åˆ—å‘ç”Ÿå˜åŒ–ã€‚</p>
</li>
<li><p>$$<br>\hat{y}(x) := \underbrace {w_0 + \sum_{i=1}^{n} w_i x_i }_{\text{çº¿æ€§å›å½’}} + \underbrace {\sum_{i=1}^{n} \sum_{j=i+1}^{n} w_{ij} x_i x_j}_{\text{äº¤å‰é¡¹ï¼ˆç»„åˆç‰¹å¾ï¼‰}} \qquad \text{(n.ml.1.9.1)}<br>$$</p>
</li>
</ul>
<p>æ¥ä¸‹æ¥æ˜¯ä½¿ç”¨å‘é‡æ–¹å¼çš„å‡½æ•°ã€‚æ ¹æ® <a href="http://cs231n.github.io/linear-classify/#softmax" target="_blank" rel="external">linear classification note</a> å†™å‡ºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">margins = np.maximum(<span class="number">0</span>, scores - scores[y] + <span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>ä½†åœ¨è¿™é‡Œæˆ‘æµ‹è¯•äº†ä¸€ä¸‹ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; print(scores[y].shape)</div><div class="line"></div><div class="line">(500,10)</div></pre></td></tr></table></figure>
<p>é¢„æ–™ä¸­ç»“æœåº”è¯¥æ˜¯ä¸€ä¸ªå‘é‡ï¼Œç”±labelç´¢å¼•æ‰€åœ¨å€¼ç»„æˆã€‚ä½†äº‹å®è¯æ˜<code>scores[y]</code>åªæ˜¯æŠŠscoersé‡æ–°æ’åˆ—äº†ä¸€æ¬¡ã€‚å‚è€ƒ<a href="https://stackoverflow.com/questions/37290879/how-to-extract-elements-from-a-matrix-using-a-vector-of-indices-using-numpy" target="_blank" rel="external">[1]</a>ï¼Œä¿®æ”¹ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">margins = np.maximum(<span class="number">0</span>, scores - scores[np.arange(scores.shape[<span class="number">0</span>]), y][:, np.newaxis] + <span class="number">1</span>)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">print(scores[0]- scores[0][y[0]]) #1</div><div class="line">print((scores - scores[np.arange(scores.shape[0]), y][:, np.newaxis])[0]) #2</div><div class="line">print((scores - scores[y])[0]) #3</div><div class="line">print(scores[0]-scores[y[0]]) #4</div></pre></td></tr></table></figure>
<p>éªŒè¯ä¸€ä¸‹ï¼š12ç»“æœä¸€è‡´ï¼Œ34ç»“æœä¸€è‡´ï¼Œ12å’Œ34ä¸ä¸€è‡´ã€‚</p>
<p>åŒæ—¶ä¹Ÿè¦è®°å¾—åœ¨marginsä¸Šä½œlabelç´¢å¼•å¤„ç†ï¼Œå®Œæ•´æ ¸å¿ƒä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">num_train = X.shape[<span class="number">0</span>]</div><div class="line">scores = X.dot(W) <span class="comment"># scores.shape =  (N, C)</span></div><div class="line">margins = np.maximum(<span class="number">0</span>, scores - scores[np.arange(num_train), y][:, np.newaxis] + <span class="number">1</span>)</div><div class="line">margins[np.arange(num_train), y] = <span class="number">0</span> </div><div class="line">loss = np.sum(margins) / num_train + reg * np.sum(W * W)</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨å‘é‡æ¥å®Œæˆæ¢¯åº¦ä¹Ÿå¡äº†æŒºä¹…ã€‚æç¤ºè¯´é‡ç”¨è®¡ç®—è¿‡çš„å€¼ï¼Œé‚£è‚¯å®šå°±æ˜¯marginså•¦ï¼Œé€šè¿‡å®ƒä»¬shapeæ¥åˆ¤æ–­äº†ä¸€ä¸‹ï¼Œä¼°æ‘¸ç€è¦ç”¨X.T(D, N) * margins(N, C)æ¥å®Œæˆï¼Œä½†æ˜¯ç©ºæƒ³ä¸å‡ºæ¥ï¼Œäºæ˜¯å†™ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥ç†è§£ä¸€ä¸‹ï¼š</p>
<p><img src="/2017/11/10/cs231n-assignment1/svm_dw.jpg" alt="IMG_3133(20171115-204831)"></p>
<p>å› ä¸ºæˆ‘ä»¬åªéœ€åˆ¤æ–­marginsæ˜¯å¦å¤§äº0ï¼Œé¦–å…ˆå°†å…¶è½¬åŒ–ä¸ºåªå«0ï¼Œ1çš„çŸ©é˜µã€‚æ¥ç€å¯ä»¥è®¡ç®—å‡ºæ¯ä¸€è¡Œ1çš„æ•°é‡ï¼ˆå³margin&gt;0çš„ä¸ªæ•°ï¼‰ï¼Œå°†åˆ†ç±»æ‰€åœ¨ä½ç½®æ”¹ä¸ºè¯¥æ•°é‡ï¼Œæœ€åä¸Xçš„è½¬ç½®ç›¸ä¹˜å³å¯ã€‚å®Œæ•´ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mat = np.zeros(margins.shape) <span class="comment"># mat.shape = N x C</span></div><div class="line">idx = np.where(margins &gt; <span class="number">0</span>) <span class="comment"># return index of margins &gt; 0</span></div><div class="line">mat[idx] = <span class="number">1</span> </div><div class="line">count = np.sum(mat, axis=<span class="number">1</span>) <span class="comment"># count the number of margins &gt; 0</span></div><div class="line">mat[np.arange(num_train), y] = -count </div><div class="line"></div><div class="line">dW = np.dot(X.T, mat) / num_train</div></pre></td></tr></table></figure>
<p>ä½†ç´ plot lossçš„ç»“æœé•¿è¿™æ ·ã€‚ã€‚ã€‚æ€»è§‰å¾—å“ªé‡Œæ€ªæ€ªçš„</p>
<p><img src="/2017/11/10/cs231n-assignment1/plot_loss.png" alt="IMG_3133(20171115-204831)"></p>
<p>ç„¶åplot weightsçš„ç»“æœé•¿è¿™æ ·ã€‚ã€‚ã€‚æ›´è§‰å¾—å“ªé‡Œæ€ªæ€ªçš„äº†</p>
<p><img src="/2017/11/10/cs231n-assignment1/plot_weights1.png" alt="IMG_3133(20171115-204831)"></p>
<p>æ„Ÿè°¢è¸©è¿‡å‘çš„åŒå­¦ <a href="https://bruceoutdoors.wordpress.com/2016/05/06/cs231n-assignment-1-tutorial-q2-training-a-support-vector-machine/" target="_blank" rel="external">https://bruceoutdoors.wordpress.com/2016/05/06/cs231n-assignment-1-tutorial-q2-training-a-support-vector-machine/</a> åŸæ¥æ˜¯dWå¿˜è®°åšæ­£åˆ™åŒ–äº†ã€‚åŠ ä¸Š<code>dW += reg * W </code>æˆ‘ä»¬å°±å¯ä»¥çœ‹è§å…‰æ»‘çš„æ›²çº¿å’Œå¤šæ ·çš„è‰²å½©äº†ï¼Œå™¢è€¶ï¼</p>
<p><img src="/2017/11/10/cs231n-assignment1/plot_loss2.png" alt="IMG_3133(20171115-204831)"></p>
<p><img src="/2017/11/10/cs231n-assignment1/plot_weights2.png" alt="IMG_3133(20171115-204831)"></p>
<h3 id="Softmax-exercise"><a href="#Softmax-exercise" class="headerlink" title="Softmax exercise"></a>Softmax exercise</h3><p>è¿™æ¬¡ä½œä¸šå’Œsvmçš„ç±»ä¼¼ï¼Œåˆ†åˆ«é€šè¿‡å¾ªç¯å’ŒçŸ©é˜µè¿ç®—å®ç°softmaxï¼Œè®¡ç®—losså’Œgradient</p>
<p>é¦–å…ˆæ˜¯é€šè¿‡å¾ªç¯å®ç°ï¼Œç†è§£ä¸€ä¸‹softmaxçš„å…¬å¼</p>
<p><img src="/2017/11/10/cs231n-assignment1/softmax_loss.png" alt=""></p>
<p>æ ¹æ® <a href="http://cs231n.stanford.edu/slides/2017/cs231n_2017_lecture3.pdf" target="_blank" rel="external">lecture3-slides</a>ï¼Œsoftmaxçš„scoresæ˜¯éæ ‡å‡†åŒ–çš„logæ¦‚ç‡ï¼ˆæ‹¬å·é‡Œçœ‹èµ·æ¥ç›¸å½“å¤æ‚ï¼Œå…¶å®å°±æ˜¯æ¦‚ç‡ï¼‰ã€‚è®¡ç®—è¿‡ç¨‹çœ‹ä¸‹å›¾æ¯”è¾ƒæ˜ç¡®ï¼š</p>
<p><img src="/2017/11/10/cs231n-assignment1/probability.png" alt=""></p>
<p>ä¸€å¼€å§‹è¿˜æŒ‰ç…§å…¬å¼å¾ªç¯è®¡ç®—ï¼Œç„¶åå‘ç°æ ‡å‡†åŒ–åï¼Œæ¦‚ç‡ç›¸åŠ ä¸º1ï¼Œå› æ­¤åªè¦å–å‡ºæ‰€å±ç±»åˆ«çš„æ¦‚ç‡logå°±å¯ä»¥äº†ï¼Œso easyï½</p>
<p>å…³äºæ¢¯åº¦çš„è®¡ç®—ç»“åˆäº†wikiä»¥åŠå‚è€ƒ <a href="https://math.stackexchange.com/questions/945871/derivative-of-softmax-loss-function" target="_blank" rel="external">derivative-of-softmax-loss-function</a> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">softmax_loss_naive</span><span class="params">(W, X, y, reg)</span>:</span></div><div class="line">  â€œâ€â€œçœç•¥éƒ¨åˆ†ä»£ç â€â€œâ€</div><div class="line">  num_train = X.shape[<span class="number">0</span>]</div><div class="line">  num_classes = W.shape[<span class="number">1</span>]</div><div class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(num_train):</div><div class="line">    scores = X[i].dot(W)  <span class="comment"># (1,C)</span></div><div class="line">    probabilities = np.exp(scores) <span class="comment"># exp</span></div><div class="line">    probabilities /= np.sum(probabilities) <span class="comment">#normalize</span></div><div class="line">    loss -= np.log(probabilities[y[i]]) <span class="comment">#log</span></div><div class="line"></div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(num_classes): <span class="comment"># pi-yi</span></div><div class="line">      <span class="keyword">if</span>(j == y[i]):</div><div class="line">        dW[:, j] += X[i] * (probabilities[y[i]] - <span class="number">1</span>)</div><div class="line">      <span class="keyword">else</span>:</div><div class="line">        dW[:, j] += X[i] * probabilities[j]</div></pre></td></tr></table></figure>
<p>ç„¶åè®©æˆ‘ä»¬è¿æ¥çŸ©é˜µçš„è®¡ç®—ï½</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">softmax_loss_vectorized</span><span class="params">(W, X, y, reg)</span>:</span></div><div class="line">  <span class="string">"""çœç•¥éƒ¨åˆ†ä»£ç """</span></div><div class="line">  num_train = X.shape[<span class="number">0</span>]</div><div class="line">  scores = X.dot(W)</div><div class="line">  probabilities = np.exp(scores) <span class="comment"># exp</span></div><div class="line">  probabilities /= np.sum(probabilities, axis=<span class="number">1</span>)[:, np.newaxis] <span class="comment"># normalize</span></div><div class="line"></div><div class="line">  mat = probabilities[np.arange(num_train), y] <span class="comment"># è·å–å¯¹åº”åˆ†ç±»çš„æ¦‚ç‡</span></div><div class="line">  loss = -np.sum(np.log(mat)) / num_train + reg * np.sum(W * W)</div><div class="line"></div><div class="line">  mat = np.zeros_like(probabilities) </div><div class="line">  mat[np.arange(num_train), y] = <span class="number">1</span> <span class="comment"># å¯¹åº”åˆ†ç±»ç½®ä¸º1</span></div><div class="line">  dW = X.T.dot(probabilities - mat) / num_train</div></pre></td></tr></table></figure>
<h3 id="Implementing-a-Neural-Network"><a href="#Implementing-a-Neural-Network" class="headerlink" title="Implementing a Neural Network"></a>Implementing a Neural Network</h3><p>lossçš„è®¡ç®—å‚è€ƒä¸Šé¢çš„softmaxï¼Œä½†æ˜¯è¦æ³¨æ„æ­£åˆ™åŒ–æ—¶W1å’ŒW2éƒ½éœ€è¦åŠ ä¸Š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># è®¡ç®—loss</span></div><div class="line">probabilities = np.exp(scores)  <span class="comment"># exp</span></div><div class="line">probabilities /= np.sum(probabilities, axis=<span class="number">1</span>)[:, np.newaxis]  <span class="comment"># normalize</span></div><div class="line">mat = probabilities[np.arange(N), y]  <span class="comment"># è·å–å¯¹åº”åˆ†ç±»çš„æ¦‚ç‡</span></div><div class="line">loss = -np.sum(np.log(mat)) / N + reg * (np.sum(W1*W1) + np.sum(W2*W2))</div></pre></td></tr></table></figure>
<p>åå‘ä¼ æ’­çš„æ—¶å€™æœ‰ä¸€é¡¹å¾ˆé‡è¦çš„<code>dh1[h1 &lt;=0] = 0</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># è®¡ç®—backward pass</span></div><div class="line"><span class="comment"># softmax gradient derivation</span></div><div class="line">dscores = probabilities</div><div class="line">dscores[range(N), y] -= <span class="number">1</span></div><div class="line">dscores /= N  <span class="comment"># (N, C)</span></div><div class="line"><span class="comment"># dW2 and db2</span></div><div class="line">grads[<span class="string">'W2'</span>] = h1.T.dot(dscores) + <span class="number">2</span> * reg * W2 <span class="comment"># (H, C)</span></div><div class="line">grads[<span class="string">'b2'</span>] = np.sum(dscores, axis=<span class="number">0</span>)</div><div class="line"><span class="comment"># next backprop into hidden layer</span></div><div class="line">dh1 = dscores.dot(W2.T) <span class="comment"># dh1.size = (N, H)</span></div><div class="line">dh1[h1 &lt;=<span class="number">0</span>] = <span class="number">0</span></div><div class="line"><span class="comment"># dW1 and db1</span></div><div class="line">grads[<span class="string">'W1'</span>] = X.T.dot(dh1) + <span class="number">2</span> * reg * W1 <span class="comment"># W1.size = (D, H)</span></div><div class="line">grads[<span class="string">'b1'</span>] = np.sum(dh1, axis = <span class="number">0</span>)</div></pre></td></tr></table></figure>
<p>ä½œä¸šè¦æ±‚è¯´æœ‰å‚æ•°çš„å¯¼æ•°å€¼ä¸æ•°å€¼è®¡ç®—å‡ºçš„å·®å€¼åº”è¯¥å°äº1e-8ï¼Œä¹‹å‰æ­£åˆ™åŒ–çš„æ—¶å€™éƒ½æ˜¯ä½¿ç”¨<code>reg * W2</code>ï¼Œä½†æ˜¯ç°åœ¨è¦ä¹˜ä»¥2ä»¥åè¯¯å·®æ‰ä¼šå°äº1e-11ï¼ˆåŒ…æ‹¬åé¢å‡†ç¡®ç‡ä¹Ÿä¼šé«˜ä¸€äº›ï¼‰</p>
<p>predictçš„æ—¶å€™æ³¨æ„ä½¿ç”¨ReLuï¼Œå¦åˆ™å°±å¡åœ¨0.38ä»¥ä¸‹ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œå‡†ç¡®ç‡ä¸Šä¸å»0.4ã€‚</p>
<p><img src="/2017/11/10/cs231n-assignment1/hs300.png" alt=""></p>
<p>ä¸‹é¢æˆ‘ä»¬è¦å¼€å§‹è°ƒå‚å•¦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">best_net = <span class="keyword">None</span> <span class="comment"># store the best model into this </span></div><div class="line">best_val = <span class="number">-1</span></div><div class="line">results = &#123;&#125;</div><div class="line"></div><div class="line">hidden_size = [<span class="number">200</span>, <span class="number">300</span>, <span class="number">500</span>, <span class="number">800</span>, <span class="number">1000</span>]</div><div class="line">learning_rate = [<span class="number">9e-4</span>]</div><div class="line">iters = [<span class="number">100</span>]</div><div class="line">regularization_strength = [<span class="number">0.01</span>]</div><div class="line"></div><div class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</div><div class="line"></div><div class="line"><span class="keyword">for</span> item <span class="keyword">in</span> product(hidden_size, learning_rate, iters, regularization_strength):</div><div class="line">    </div><div class="line">    hs = item[<span class="number">0</span>]</div><div class="line">    lr = item[<span class="number">1</span>]</div><div class="line">    it = item[<span class="number">2</span>]</div><div class="line">    rg = item[<span class="number">3</span>]</div><div class="line">    net = TwoLayerNet(input_size, hs, num_classes)</div><div class="line"></div><div class="line">    <span class="comment"># Train the network</span></div><div class="line">    stats = net.train(X_train, y_train, X_val, y_val,</div><div class="line">                num_iters=it, batch_size=<span class="number">200</span>,</div><div class="line">                learning_rate=lr, learning_rate_decay=<span class="number">0.95</span>,</div><div class="line">                reg=rg, verbose=<span class="keyword">False</span>)</div><div class="line"></div><div class="line">    <span class="comment"># Predict on the validation set</span></div><div class="line">    val_acc = (net.predict(X_val) == y_val).mean()</div><div class="line">    train_acc = (net.predict(X_train) == y_train).mean()</div><div class="line">    results[(hs, lr, it, rg)] = (train_acc, val_acc)</div><div class="line">    </div><div class="line">    <span class="comment"># Check best validation accuracy</span></div><div class="line">    <span class="keyword">if</span>(val_acc &gt; best_val):</div><div class="line">        best_val = val_acc</div><div class="line">        best_net = net</div><div class="line">        </div><div class="line"><span class="comment"># Print out results.\</span></div><div class="line"><span class="keyword">for</span> hs, lr, it, reg <span class="keyword">in</span> sorted(results):</div><div class="line">    </div><div class="line">    train_acc, val_acc = results[(hs, lr, it, reg)]</div><div class="line">    print(<span class="string">'hs:%d it:%d lr:%e rg:%e train_acc:%f val_accï¼š%f'</span> %(hs, it, lr, reg, train_acc, val_acc))</div><div class="line">print(<span class="string">'best validation accuracy achieved during cross-validation: %f'</span> % best_val)</div></pre></td></tr></table></figure>
<p>é¦–å…ˆæˆ‘ä»¬å›ºå®šå­¦ä¹ ç‡ã€è¿­ä»£æ¬¡æ•°ï¼ˆå°ä¸€ç‚¹ï¼‰ã€æ­£åˆ™åŒ–ç³»æ•°ï¼Œä¿®æ”¹éšè—å±‚å¤§å° = [200, 300, 500, 800, 1000]</p>
<p><img src="/2017/11/10/cs231n-assignment1/change_hs.png" alt=""></p>
<p>å¾ˆæ˜æ˜¾éšè—å±‚è¶Šå¤§ç²¾ç¡®åº¦æ›´é«˜ï¼Œæ¥ä¸‹æ¥å›ºå®šå…¶ä»–å‚æ•°ï¼Œæ¥è°ƒæ•´ä¸€ä¸‹å­¦ä¹ ç‡</p>
<p>å‘ç°å­¦ä¹ ç‡åœ¨ &gt; -e2 æ•°é‡çº§éƒ½ä¼šæŠ¥é”™ï¼Ÿï¼Ÿï¼Ÿåº”è¯¥æ˜¯å­¦ä¹ ç‡å¤ªå¤§ä¼šå¯¼è‡´Wè¶…å‡º-1åˆ°1çš„èŒƒå›´å§ã€‚</p>
<p><img src="/2017/11/10/cs231n-assignment1/learning_rate_error.png" alt=""></p>
<p>æµ‹è¯•å­¦ä¹ ç‡ = [3e-3, 4e-4, 5e-5, 6e-6]</p>
<p><img src="/2017/11/10/cs231n-assignment1/change_lr1.png" alt=""></p>
<p>ä¼¼ä¹å­¦ä¹ ç‡å¤§ä¸€äº›çš„ç»“æœæ¯”è¾ƒå¥½ï¼Œé‚£åœ¨è¿™ä¸ªæ•°é‡çº§å‘¨å›´å†æµ‹è¯•ä¸€ä¸‹</p>
<p><img src="/2017/11/10/cs231n-assignment1/change_lr2.png" alt=""></p>
<p>8e-2çš„å­¦ä¹ ç‡è¿˜æ˜¯å´©å•¦ï¼Œè¿™æ ·çœ‹èµ·æ¥å­¦ä¹ ç‡è®¾ç½®æˆ2e=eä¼šæ¯”è¾ƒå¥½ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è°ƒå¤§è¿­ä»£æ¬¡æ•°å’Œéšè—å±‚å¤§å°ï¼Œæ¥è°ƒæ•´æ­£åˆ™åŒ–å‚æ•°</p>
<p><img src="/2017/11/10/cs231n-assignment1/change_hs_rg.png" alt=""></p>
<p>å˜»å˜»æœ€é«˜åˆ°0.534äº†ï¼Œå¯ä»¥åŠ åˆ†äº†ï½</p>
<p><strong>å‚è€ƒé“¾æ¥</strong></p>
<ul>
<li><a href="https://stackoverflow.com/questions/37290879/how-to-extract-elements-from-a-matrix-using-a-vector-of-indices-using-numpy" target="_blank" rel="external">https://stackoverflow.com/questions/37290879/how-to-extract-elements-from-a-matrix-using-a-vector-of-indices-using-numpy</a></li>
</ul>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#k-Nearest-Neighbor-kNN-exercise"><span class="toc-number">1.</span> <span class="toc-text">k-Nearest Neighbor (kNN) exercise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Multiclass-Support-Vector-Machine-exercise"><span class="toc-number">2.</span> <span class="toc-text">Multiclass Support Vector Machine exercise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Softmax-exercise"><span class="toc-number">3.</span> <span class="toc-text">Softmax exercise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Implementing-a-Neural-Network"><span class="toc-number">4.</span> <span class="toc-text">Implementing a Neural Network</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2017/11/10/cs231n-assignment1/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&text=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&title=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&is_video=false&description=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=cs231n assignment1 å­¦ä¹ ç¬”è®°&body=Check out this article: http://yoursite.com/2017/11/10/cs231n-assignment1/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&title=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&title=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&title=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&title=cs231n assignment1 å­¦ä¹ ç¬”è®°"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2017/11/10/cs231n-assignment1/&name=cs231n assignment1 å­¦ä¹ ç¬”è®°&description=&lt;p&gt;ä½œä¸šçš„è¿è¡Œç¯å¢ƒæˆ‘é€‰æ‹©ã€ŒWorking locallyã€ã€‚åœ¨é…ç½®è™šæ‹Ÿç¯å¢ƒè¿‡ç¨‹ä¸­ï¼ŒæœçœŸé‡åˆ° matplotlib è¿è¡Œä¸äº†çš„é—®é¢˜ï¼Œå‚è€ƒ &lt;a href=&#34;https://matplotlib.org/faq/osx_framework.html#osxframework-faq&#34; target=&#34;_blank&#34; rel=&#34;external&#34;&gt;Working with Matplotlib on OSX&lt;/a&gt;ï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼Œå‡ ä¹æ¯ç§æ–¹æ³•è®¾ç½®ä¸€éï¼Œé‡å¯äº†å¥½å‡ æ¬¡è™šæ‹Ÿç¯å¢ƒï¼Œæœ€åå¯ä»¥ç”¨ jupyter notebook æ‰“å¼€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;k-Nearest-Neighbor-kNN-exercise&#34;&gt;&lt;a href=&#34;#k-Nearest-Neighbor-kNN-exercise&#34; class=&#34;headerlink&#34; title=&#34;k-Nearest Neighbor (kNN) exercise&#34;&gt;&lt;/a&gt;k-Nearest Neighbor (kNN) exercise&lt;/h3&gt;&lt;p&gt;ç‚¹å‡»ã€Œrunã€æ‰§è¡Œæ¯ä¸ªæ¡†æ¡†ï¼Œ&lt;code&gt;dists = classifier.compute_distances_two_loops(X_test)&lt;/code&gt; çœŸçš„è¦è¿è¡Œéå¸¸éå¸¸éå¸¸ä¹…ï¼ŒåŒæ—¶æ¡†æ¡†å·¦è¾¹ä¼šå·¦è¾¹å˜æˆ In [*]ï¼Œç„¶åæˆ‘å‚»å‚»çš„ä»¥ä¸ºå¡äº†ï¼Œé‡å¯äº†å¥½å¤šæ¬¡ï¼Œåæ¥æ‰é†’æ‚Ÿè¿™æ˜¯æ­£åœ¨è¿è¡Œçš„æ„æ€ã€‚&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Colorjam
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- particles -->
<script src="/lib/particles/particles.min.js"></script>
<script type="text/javascript">
    particlesJS('particles-js', {
        "particles": {
            "number": {
            "value": 60,
            "density": {
                "enable": true,
                "value_area": 1200
            }
            },
            "color": {
            "value": "#d25e5e"
            },
            "shape": {
            "type": "circle",
            "stroke": {
                "width": 0,
                "color": "#000000"
            },
            "polygon": {
                "nb_sides": 3
            },
            "image": {
                "src": "img/github.svg",
                "width": 100,
                "height": 100
            }
            },
            "opacity": {
            "value": 0.35,
            "random": false,
            "anim": {
                "enable": false,
                "speed": 1,
                "opacity_min": 0.1,
                "sync": false
            }
            },
            "size": {
            "value": 2,
            "random": true,
            "anim": {
                "enable": false,
                "speed": 40,
                "size_min": 0.1,
                "sync": false
            }
            },
            "line_linked": {
            "enable": true,
            "distance": 150,
            "color": "#e88181",
            "opacity": 0.352750653390415,
            "width": 0.9620472365193136
            },
            "move": {
            "enable": true,
            "speed": 6,
            "direction": "none",
            "random": false,
            "straight": false,
            "out_mode": "out",
            "bounce": false,
            "attract": {
                "enable": false,
                "rotateX": 600,
                "rotateY": 1200
            }
            }
        },
        "interactivity": {
            "detect_on": "canvas",
            "events": {
            "onhover": {
                "enable": true,
                "mode": "repulse"
            },
            "onclick": {
                "enable": true,
                "mode": "push"
            },
            "resize": true
            },
            "modes": {
            "grab": {
                "distance": 400,
                "line_linked": {
                "opacity": 1
                }
            },
            "bubble": {
                "distance": 400,
                "size": 40,
                "duration": 2,
                "opacity": 8,
                "speed": 3
            },
            "repulse": {
                "distance": 200,
                "duration": 0.4
            },
            "push": {
                "particles_nb": 4
            },
            "remove": {
                "particles_nb": 2
            }
            }
        },
        "retina_detect": true
        });
</script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


