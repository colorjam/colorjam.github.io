<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> cs231n assignment1 å­¦ä¹ ç¬”è®° Â· Colorjam's Blog</title><meta name="description" content="cs231n assignment1 å­¦ä¹ ç¬”è®° - Colorjam"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Colorjam's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/pinkladies" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">cs231n assignment1 å­¦ä¹ ç¬”è®°</h1><div class="post-info">Nov 10, 2017</div><div class="post-content"><p>ä½œä¸šçš„è¿è¡Œç¯å¢ƒæˆ‘é€‰æ‹©ã€ŒWorking locallyã€ã€‚åœ¨é…ç½®è™šæ‹Ÿç¯å¢ƒè¿‡ç¨‹ä¸­ï¼ŒæœçœŸé‡åˆ° matplotlib è¿è¡Œä¸äº†çš„é—®é¢˜ï¼Œå‚è€ƒ <a href="https://matplotlib.org/faq/osx_framework.html#osxframework-faq" target="_blank" rel="external">Working with Matplotlib on OSX</a>ï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼Œå‡ ä¹æ¯ç§æ–¹æ³•è®¾ç½®ä¸€éï¼Œé‡å¯äº†å¥½å‡ æ¬¡è™šæ‹Ÿç¯å¢ƒï¼Œæœ€åå¯ä»¥ç”¨ jupyter notebook æ‰“å¼€ã€‚</p>
<h3 id="k-Nearest-Neighbor-kNN-exercise"><a href="#k-Nearest-Neighbor-kNN-exercise" class="headerlink" title="k-Nearest Neighbor (kNN) exercise"></a>k-Nearest Neighbor (kNN) exercise</h3><p>ç‚¹å‡»ã€Œrunã€æ‰§è¡Œæ¯ä¸ªæ¡†æ¡†ï¼Œ<code>dists = classifier.compute_distances_two_loops(X_test)</code> çœŸçš„è¦è¿è¡Œéå¸¸éå¸¸éå¸¸ä¹…ï¼ŒåŒæ—¶æ¡†æ¡†å·¦è¾¹ä¼šå·¦è¾¹å˜æˆ In [*]ï¼Œç„¶åæˆ‘å‚»å‚»çš„ä»¥ä¸ºå¡äº†ï¼Œé‡å¯äº†å¥½å¤šæ¬¡ï¼Œåæ¥æ‰é†’æ‚Ÿè¿™æ˜¯æ­£åœ¨è¿è¡Œçš„æ„æ€ã€‚</p>
<a id="more"></a>
<p>è¿›è¡Œé¢„æµ‹çš„æ—¶å€™å‘ç°å‡†ç¡®åº¦æ— è®ºå¦‚ä½•éƒ½æ˜¯0.14ï¼ŒæŸ¥äº†ä¸€ä¸‹å‘ç° <code>predict_labels</code> å‡½æ•°æ²¡æœ‰ä¿®æ”¹ğŸ˜‚ </p>
<p>äºŒæ¬¡å¾ªç¯çš„å‡½æ•°æ¯”è¾ƒç®€å•ï¼Œä¸€æ¬¡å¾ªç¯è¾¹æ´—æ¾¡è¾¹æ€è€ƒï¼Œç„¶åå¤´è„‘é£æš´çŸ©é˜µå˜æ¢ï¼Œå¼€å¿ƒåœ°æƒ³å‡ºæ¥äº†â˜ºï¸ æ ¸å¿ƒä»£ç <code>dists[i, :] = np.sqrt(np.sum((X[i, :] - self.X_train) ** 2, axis = 1)).T</code></p>
<p>æ— å¾ªç¯å‡½æ•°ä¼°æ‘¸ç€åº”è¯¥æ˜¯è¦è¿ç”¨æ•°å­¦å…¬å¼æ¥è§£å†³ã€‚å‡è®¾æµ‹è¯•é›†(2x3)ï¼š<br>$$<br>testX = \begin{pmatrix}x_{11}&amp;x_{12}&amp;x_{13} \\x_{21}&amp;x_{22}&amp;x_{23}\ \end{pmatrix}<br>$$<br>è®­ç»ƒé›†(4x3)ï¼š<br>$$<br>trainX = \begin{pmatrix}y_{11}&amp;y_{12}&amp;y_{13} \\y_{21}&amp;y_{22}&amp;y_{23}\\y_{31}&amp;y_{32}&amp;y_{33}\\y_{41}&amp;y_{42}&amp;y_{43}\ \end{pmatrix}<br>$$<br>æœ€åç”Ÿæˆ dist (2x4) çš„è·ç¦»çŸ©é˜µï¼Œè‡ªç„¶è”æƒ³åˆ°çŸ©é˜µä¹˜æ³• (2x4) := (2x3) x (3x4)ã€‚åˆšå¥½ä»£ç ä¸­ä¹Ÿæœ‰æç¤ºçŸ©é˜µä¹˜æ³•ï¼Œé‚£ä¹ˆ \(trainX\) å¿…ç„¶æ˜¯è½¬ç½®ä¸€ä¸‹çš„ã€‚<br>$$<br>trainX^T = \begin{pmatrix}y_{11}&amp;y_{21}&amp;y_{31}&amp;y_{41} \\y_{12}&amp;y_{22}&amp;y_{32}&amp;y_{42}\\y_{13}&amp;y_{23}&amp;y_{33}&amp;y_{43}\\ \end{pmatrix}<br>$$<br>æˆ‘ä»¬å–å‡ºä¸€ä¸ªæµ‹è¯•é›†å’Œä¸€ä¸ªè®­ç»ƒé›†ï¼Œè®¡ç®—ä¸€ä¸‹å®ƒä»¬çš„æ¬§æ°è·ç¦»ï¼š<br>$$<br>dist[1, 1] = \sqrt{(x_{11}-y_{11})^2 + (x_{12}-y_{12})^2 + (x_{13}-y_{13})^2 }<br>$$<br>æˆ‘ä»¬è¯•ä¸€ä¸‹æŠŠæ¯ä¸ªå¹³æ–¹æ‹†å¼€ï¼š<br>$$<br>dist[1, 1] = \sqrt{x_{11}^2 - 2x_{11}y_{11}+y_{11}^2 + x_{12}^2 - 2x_{12}y_{12}+y_{12}^2+x_{13}^2 - 2x_{13}y_{13}+y_{13}^2}<br>$$<br>æ•´ç†å‡ºæ ¹å·é‡Œå¤´çš„å®¶ä¼™ï¼š<br>$$<br>x_{11}^2+ x_{12}^2+x_{13}^2 +y_{11}^2+y_{12}^2 +y_{13}^2 - 2(x_{11}y_{11}   +x_{12}y_{12}+ x_{13}y_{13})<br>$$<br>å—¯ã€‚ã€‚ã€‚å†ä¸€æ¬¡æ„Ÿå¹æ•°å­¦ä¹‹ç¾ã€‚ã€‚ã€‚äºæ˜¯ã€Œæ ¹å·é‡Œå¤´çš„å®¶ä¼™ã€å°±è¢«åˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†</p>
<ul>
<li>\(x_{11}^2+ x_{12}^2x_{13}^2\) ç›¸å½“äº \(testX\) å…ƒç´ å¹³æ–¹ï¼Œå†æŒ‰åˆ—ç›¸åŠ ï¼Œå³æŠŠçŸ©é˜µå‹ç¼©æˆä¸€åˆ—ã€‚</li>
<li>\(y_{11}^2+y_{12}^2 +y_{13}^2\) ç›¸å½“äº \(trainX^T\) å…ƒç´ å¹³æ–¹ï¼Œå†æŒ‰è¡Œç›¸åŠ  ï¼Œå³æŠŠçŸ©é˜µå‹ç¼©æˆä¸€è¡Œã€‚</li>
<li>\(x_{11}y_{11}   +x_{12}y_{12}+ x_{13}y_{13}\) ç›¸å½“äº\(testX * trainX\)</li>
</ul>
<p>äºæ˜¯å°±å¯ä»¥ <strong>broadcasting</strong> å•¦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">transXtrain = self.X_train.T <span class="comment"># è½¬ç½®è®­ç»ƒé›†</span></div><div class="line">sumX = np.sum(X ** <span class="number">2</span>, axis = <span class="number">1</span>)[:, np.newaxis] <span class="comment">#ï¼ˆ500x1ï¼‰</span></div><div class="line">sumtransXtrain = np.sum(transXtrain ** <span class="number">2</span>, axis = <span class="number">0</span>)[np.newaxis] <span class="comment">#ï¼ˆ1x5000ï¼‰</span></div><div class="line">dists = np.sqrt( sumX + sumtransXtrain - <span class="number">2</span> * np.dot(X, transXtrain)) <span class="comment"># broadcasting &amp; matrix multiplication</span></div></pre></td></tr></table></figure>
<p>æœ€åä¸€ä¸ªéƒ¨åˆ†æ˜¯å…³äºk-æŠ˜äº¤å‰éªŒè¯ï¼Œæ ¹æ®ä½œä¸šæç¤ºï¼Œå¾ªç¯æ¯ä¸ªå¯èƒ½çš„kå€¼ï¼Œè¿è¡Œk-nnç®—æ³• num_folds æ¬¡ï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªå­é›†ä½œä¸ºè®­ç»ƒé›†ï¼Œæœ€åä¸€ä¸ªå­é›†ä¸ºéªŒè¯é›†ã€‚ä½†å‚è€ƒäº†ç½‘ä¸Šå…³äº10æŠ˜äº¤å‰éªŒè¯çš„è¯´æ³•ï¼Œæ˜¯è½®æµå°†å…¶ä¸­9ä»½ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œ1ä»½ä½œä¸ºæµ‹è¯•æ•°æ®çš„ã€‚æ‰€ä»¥æˆ‘å°±å¾ªç¯äº†num+folds-1æ¬¡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">size = X_train_folds[<span class="number">0</span>].shape[<span class="number">0</span>]</div><div class="line"><span class="keyword">for</span> k <span class="keyword">in</span> k_choices:</div><div class="line">    k_to_accuracies[k] = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(num_folds<span class="number">-1</span>): <span class="comment"># each case </span></div><div class="line">        classifier.train(X_train_folds[i], y_train_folds[i]) <span class="comment"># use one as training data</span></div><div class="line">        predict_labels = classifier.predict(X_train_folds[<span class="number">-1</span>], k, num_loops = <span class="number">0</span>)</div><div class="line">        accuracy = sum(predict_labels == y_train_folds[<span class="number">-1</span>]) / size <span class="comment"># last fold as validation set</span></div><div class="line">        k_to_accuracies[k].append(accuracy)</div></pre></td></tr></table></figure>
<p><img src="/2017/11/10/cs231n-assignment1/knn.png" alt="cross-validation"></p>
<p>æœ€åæ ¹æ®äº¤å‰éªŒè¯çš„ç»“æœé€‰æ‹©k=8æœ€ä½³ã€‚</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/11/05/machine-learning-in-action-note5/" class="next">NEXT</a></div><div class="copyright"><p>Â© 2015 - 2017 <a href="http://yoursite.com">Colorjam</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>