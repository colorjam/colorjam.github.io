<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <%- open_graph({
        image:          thumbnail(page),
        fb_app_id:      theme.open_graph.fb_app_id,
        fb_admins:      theme.open_graph.fb_admins,
        twitter_id:     theme.open_graph.twitter_id,
        google_plus:    theme.open_graph.google_plus,
    }) %>
    <%- meta(page) %>
    <% if (theme.favicon) { %>
        <% if (theme.favicon.desktop) { %>
          <% if (theme.gravatar.email && theme.favicon.desktop.gravatar) { %>
              <link rel="shortcut icon" href="<%= gravatar(theme.gravatar.email, 16) %>">
          <% } else { %>
              <link rel="shortcut icon" href="<%= url_for(theme.favicon.desktop.url) %>">
          <% } %>
        <% } %>
        <% if (theme.favicon.android) { %>
          <% if (theme.gravatar.email && theme.favicon.android.gravatar) { %>
            <link rel="icon" type="image/png" href="<%= gravatar(theme.gravatar.email, 192) %>" sizes="192x192">
          <% } else { %>
            <link rel="icon" type="image/png" href="<%= url_for(theme.favicon.android.url) %>" sizes="192x192">
          <% } %>
        <% } %>
        <% if (theme.favicon.apple) { %>
          <% if (theme.gravatar.email && theme.favicon.apple.gravatar) { %>
            <link rel="apple-touch-icon" sizes="180x180" href="<%= gravatar(theme.gravatar.email, 180) %>">
          <% } else { %>
            <link rel="apple-touch-icon" sizes="180x180" href="<%= url_for(theme.favicon.apple.url) %>">
          <% } %>
        <% } %>
    <% } %>
    <!-- title -->
    <title><%= page.title ? page.title : config.title %></title>
    <!-- styles -->
    <%- css('css/style') %>
    <!-- persian styles -->
    <% if (theme.direction) { %>
      <%- css('css/rtl') %>
    <% } %>
    <!-- rss -->
    <% if (theme.rss === '' && config.feed && config.feed.path) { %>
      <% theme.rss = config.feed.path %>
    <% } %>
    <% if (theme.rss) { %>
      <link rel="alternate" href="<%= url_for(theme.rss) %>" title="<%= config.title %>" type="application/atom+xml" />
    <% } %>
</head>


<div id="particles-js"></div>
<body class="max-width mx-auto px3 ltr">    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <% for (var i in theme.nav) { %> 
          <li><a href="<%- url_for(theme.nav[i]) %>"><%= __('nav.'+i).replace("nav.", "") %></a></li>
        <% } %>
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        <% if (page.prev) { %>
        <li><a class="icon" href="<%- url_for(page.prev.path) %>"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        <% } %>
        <% if (page.next) { %>
        <li><a class="icon" href="<%- url_for(page.next.path) %>"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        <% } %>
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;"><%= __('post.desktop.previous') %></span>
      <span id="i-next" class="info" style="display:none;"><%= __('post.desktop.next') %></span>
      <span id="i-top" class="info" style="display:none;"><%= __('post.desktop.back_to_top') %></span>
      <span id="i-share" class="info" style="display:none;"><%= __('post.desktop.share') %></span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <%- partial('_partial/post/share', { icon_class_name: '' }) %>
    </div>
    <div id="toc">
      <%- toc(page.content) %>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <% if (index) { %>
    <% if (post.link) { %>
        <a class="<%= class_name %>" href="<%- url_for(post.link) %>" target="_blank" itemprop="url"><%= post.title %></a>
    <% } else if (post.title) { %>
        <a class="<%= class_name %>" href="<%- url_for(post.path) %>"><%= post.title %></a>
    <% } else { %>
        <a class="<%= class_name %>" href="<%- url_for(post.path) %>">Untitled</a>
    <% } %>
<% } else { %>
    <h1 class="<%= class_name %>" itemprop="name headline">
        <%= post.title %>
    </h1>
<% } %>


    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Colorjam</span>
      </span>
      <% if (post.date) { %>
    <div class="<%= class_name %>">
        <time datetime="<%= date_xml(post.date) %>" itemprop="datePublished"><%= date(post.date, config.date_format) %></time>
    </div>
<% } %>

      <% if (page.tags && page.tags.length) { %>
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <%- list_tags(page.tags, { show_count: false, style: 'link' }) %>
    </div>
<% } %>

    </div>
  </header>
  <% if (page.photos && page.photos.length) { %>
<div class="article-gallery">
    <% page.photos.forEach(function(photo, i) { %>
    <a class="gallery-item" href="<%- url_for(photo) %>" rel="gallery_<%= page._id %>">
        <img src="<%- url_for(photo) %>" itemprop="image" />
    </a>
    <% }) %>
</div>
<% } %>

  <div class="content" itemprop="articleBody">
    <p>æ”¯æŒå‘é‡æœºï¼ˆSupport Vector Machineï¼‰çœŸçš„ä¸æ˜¯å¾ˆå¥½ç†è§£å•Šï¼Œè™½ç„¶ä½œè€…ç»™å‡ºäº†ä»£ç ï¼Œemmmmmâ€¦..è¿˜æ˜¯ç¨å¾®è®°å½•ä¸€ä¸‹å§ã€‚</p>
<p>ä¸Šä¸€ç« å­¦ä¹ çš„ã€Œå¯¹æ•°å‡ ç‡å‡½æ•°ã€ä¸­ï¼Œæˆ‘ä»¬æåˆ°äº†</p>
<blockquote>
<p>åˆ©ç”¨çº¿æ€§å›å½’æ¨¡å‹çš„é¢„æµ‹ç»“æœå»é€¼è¿‘çœŸå®æ ‡è®°çš„å¯¹æ•°å‡ ç‡</p>
</blockquote>
<p>æ ‡è®°ç»“æœä¸º1ï¼0ã€‚ä½†SVMä¸­ï¼Œæˆ‘ä»¬ç›®æ ‡æ˜¯æ‰¾å‡ºå…·æœ‰â€œæœ€å¤§é—´éš”â€ï¼ˆmaximum marginï¼‰çš„ã€Œåˆ’åˆ†è¶…å¹³é¢ã€ï¼Œæ ‡è®°ç»“æœä¸º-1ï¼1ã€‚</p>
<p>ä¸Šé¢ä¸€å¥è¯å‡ºç°äº†ä¸¤ä¸ªå¥½åƒä¼¼æ‡‚éæ‡‚çš„åè¯ï¼šæœ€å¤§é—´éš”å’Œåˆ’åˆ†è¶…å¹³é¢ã€‚</p>
<p><img src="/2017/10/22/machine-learning-in-action-note4/svmpic.jpg" alt="svmpic"></p>
<a id="more"></a>
<p>ğŸ‘†ğŸ»æœ‰ä¸€æ¡çº¿æŠŠè‹¹æœå’Œé¦™è•‰åˆ†å¼€äº†ï¼ˆåœ¨äºŒç»´ç©ºé—´ä¸­å°±æ˜¯ä¸€æ¡çº¿ï¼‰ï¼Œè¿™æ ·åˆ†å¼€ä¸åŒè®­ç»ƒæ ·æœ¬çš„çº¿å°±ç§°ä¸ºã€Œåˆ’åˆ†è¶…å¹³é¢ã€ã€‚è·ç¦»è¿™æ¡çº¿æœ€è¿‘çš„å‡ ä¸ªç‚¹å°±æ˜¯ã€Œæ”¯æŒå‘é‡ã€ï¼Œå®ƒä»¬åˆ°è¿™æ¡çº¿çš„è·ç¦»å°±ä¸ºã€Œé—´éš”ã€ã€‚é‚£ä¹ˆæˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹åˆšè¯´çš„ä¸€å¥è¯ï¼š</p>
<blockquote>
<p>æ‰¾å‡ºå…·æœ‰â€œæœ€å¤§é—´éš”â€ï¼ˆmaximum marginï¼‰çš„ã€Œåˆ’åˆ†è¶…å¹³é¢ã€</p>
</blockquote>
<p>èƒ½å¤Ÿåˆ’åˆ†è®­ç»ƒæ ·æœ¬çš„è¶…å¹³é¢å¯èƒ½æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬åº”è¯¥è¦æ‰¾çš„ï¼Œæ˜¯ä½äºâ€œæ­£ä¸­é—´â€çš„é‚£ä¸ªåˆ’åˆ†è¶…å¹³é¢ï¼Œä¹Ÿå°±æ˜¯è·ç¦»ä¸åŒç±»åˆ«éƒ½å°½å¯èƒ½è¿œçš„é‚£ä¸ªè¶…å¹³é¢ã€‚è¿™æ ·è¿›è¡Œé¢„æµ‹æ—¶è¯¯å·®æ‰ä¼šå°½å¯èƒ½å°ã€‚</p>
<p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ˜ç¡®ä¸€ä¸‹SVMç®—æ³•çš„è®¾è®¡é—®é¢˜äº†ã€‚å› ä¸ºè¶Šæ¥è¿‘è¶…å¹³é¢çš„ç‚¹è¶Šâ€œéš¾â€åˆ†å‰²ï¼Œæ‰¾åˆ°è¿™äº›ç‚¹å°±ä¸‡äº‹å¤§å‰äº†ã€‚å› æ­¤SVMå­¦ä¹ åˆ†ç±»å™¨æœ€é‡è¦çš„æ˜¯æ‰¾åˆ°å“ªäº›æ ·æœ¬ä½œä¸ºã€Œæ”¯æŒå‘é‡ã€ã€‚å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜ã€‚</p>
<p>ä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜é€šå¸¸æœ‰ä¸¤ä¸ªæœ€åŸºæœ¬çš„å› ç´ ï¼š1ï¼‰ç›®æ ‡å‡½æ•°ï¼šå¸Œæœ›ä»€ä¹ˆä¸œè¥¿çš„æŒ‡æ ‡è¾¾åˆ°æœ€å¥½ï¼›2ï¼‰ä¼˜åŒ–å¯¹è±¡ï¼šä½ å¸Œæœ›é€šè¿‡æ”¹å˜å“ªäº›å› ç´ ä½¿ç›®æ ‡å‡½æ•°è¾¾åˆ°æœ€ä¼˜ã€‚åœ¨SVMä¸­ï¼Œç›®æ ‡å‡½æ•°æ˜¯ã€Œæœ€å¤§é—´éš”ã€ï¼Œä¼˜åŒ–å¯¹è±¡å°±æ˜¯ã€Œåˆ’åˆ†è¶…å¹³é¢ã€ã€‚ä¸‹é¢æˆ‘ä»¬å°±éœ€è¦å¯¹è¿™ä¸¤ä¸ªåŸºæœ¬å› ç´ è¿›è¡Œæ•°å­¦æè¿°ã€‚</p>
<p>###SVMçš„æ•°å­¦å»ºæ¨¡</p>
<p><img src="/2017/10/22/machine-learning-in-action-note4/svm_model.png" alt="svmpic"></p>
<p>åˆ’åˆ†è¶…å¹³é¢çš„çº¿æ€§æ–¹ç¨‹ï¼š<br>$$<br>w^Tx + b = 0<br>$$<br>å…¶ä¸­ï¼Œ<strong>w</strong> = ï¼ˆw~1~ï¼› w~2~ï¼›â€¦ ï¼› w~d~ï¼‰ä¸ºæ³•å‘é‡ã€‚æ ·æœ¬ç©ºé—´ä¸­ä»»æ„ç‚¹ <strong>x</strong> åˆ°è¶…å¹³é¢çš„è·ç¦»ï¼ˆå‡ ä½•é—´éš”ï¼‰å¯å†™ä¸ºï¼š<br>$$<br>d = \frac{|w^Tx + b|}{||w||}<br>$$<br>å…¶ä¸­ï¼Œ$||w||$ ä¸ºå‘é‡çš„æ¨¡ã€‚å‰é¢æˆ‘ä»¬è¯´åˆ°ï¼ŒSVMçš„åˆ†ç±»ç»“æœæ˜¯+1ï¼-1ï¼Œä»¤ï¼š<br>$$<br>\begin{cases}w^Tx + bâ‰¥+1, y_i = +1 \\ w^Tx + bâ‰¤-1, y_i = -1<br>\end{cases}<br>$$<br>æ”¯æŒå‘é‡ä½¿å¾—ç­‰å·æˆç«‹ã€‚ä¸¤ä¸ªå¼‚ç±»æ”¯æŒå‘é‡åˆ°è¶…å¹³é¢çš„è·ç¦»ä¹‹å’Œä¸º<br>$$<br>ğœ¸ = \frac{2}{||w||}<br>$$<br>æ˜¾ç„¶ï¼Œä¸ºäº†æœ€å¤§åŒ–é—´éš”ï¼Œä»…éœ€æœ€å¤§åŒ–$||w||^{-1}$ï¼Œç­‰ä»·äºæœ€å°åŒ–$||w||^2$ã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ç»™å‡ºSVMçš„æ•°å­¦æè¿°ï¼š<br>$$<br>\min_{w,b}\frac{1}{2}||w||^2 \\  s.t. \quad y_i(w^Tx+b) â‰¥1,i = 1,2,â€¦,m<br>$$</p>
<p>ç¼©å†™s. t. è¡¨ç¤ºâ€œSubject toâ€ï¼Œæ˜¯â€œæœä»æŸæŸæ¡ä»¶â€çš„æ„æ€ã€‚æ ¹æ®å‚è€ƒé“¾æ¥[3]è§£é‡Šä¸€ä¸‹è¿™ä¸ªæ¡ä»¶çš„å«ä¹‰ã€‚æˆ‘ä»¬å®šä¹‰ã€Œå‡½æ•°é—´éš”ã€ä¸º<br>$$<br>y(w^Tx+b)=yf(x)â‰¥ğœ¸<br>$$<br>å‰é¢ä¹˜ä¸Šç±»åˆ« y ä¹‹åä¿è¯é—´éš”çš„éè´Ÿæ€§ï¼ˆå› ä¸º f(x)&lt;0 å¯¹åº”äº y=âˆ’1 çš„é‚£äº›ç‚¹ï¼‰ã€‚</p>
<p>###å¯¹å¶é—®é¢˜</p>
<p>ä¸Šé¢SVMçš„æ•°å­¦æè¿°å…¶å®æ˜¯ä¸€ä¸ª<strong>äºŒæ¬¡ä¼˜åŒ–é—®é¢˜</strong>â€”â€”ç›®æ ‡å‡½æ•°æ˜¯äºŒæ¬¡çš„ï¼Œçº¦æŸæ¡ä»¶æ˜¯çº¿æ€§çš„ã€‚å¼•å…¥ã€Œæ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ã€æ±‚è§£ï¼Œå¯¹æ¯æ¡çº¦æŸæ·»åŠ æ‹‰æ ¼æœ—æ—¥ä¹˜å­ğœ¶~i~ â‰¥ 0ï¼Œåˆ™è¯¥é—®é¢˜çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°å¯å†™ä¸º<br>$$<br>Lï¼ˆw,b,ğœ¶) =\frac{1}{2}||w||^2 + ğœ¶_i\sum_{i=1}^m(1-y_i(w^Tx_i+b))<br>$$<br>å…¶ä¸­ï¼Œ\(ğœ¶ = ï¼ˆğ›¼_1;ğ›¼_2;â€¦;ğ›¼_m)\)ã€‚æˆ‘ä»¬ä»¤<br>$$<br>ğœƒ(w) =\max _{ğœ¶_iâ‰¥ 0}\quad Lï¼ˆw,b,ğœ¶)<br>$$</p>
<p>åˆ™ä¸Šå¼çš„æœ€ä¼˜å€¼ä¸º $ğœƒ(w) = \frac{1}{2}||w||^2$, å³æˆ‘ä»¬éœ€è¦ä¼˜åŒ–çš„SVMæ•°å­¦æ¨¡å‹ã€‚å…·ä½“å…¬å¼ä¸º</p>
<p>$$<br>\min_{w,b} ğœƒ(w)  =\min_{w,b}\max_{ğœ¶_iâ‰¥ 0}\quad Lï¼ˆw,b,ğœ¶)<br>$$<br>å°†minå’Œmaxäº¤æ¢ä½ç½®å¾—åˆ°åŸå§‹é—®é¢˜çš„å¯¹å¶é—®é¢˜</p>
<p>$$<br>\max_{ğœ¶_iâ‰¥ 0}\min_{w,b}\quad Lï¼ˆw,b,ğœ¶)<br>$$<br><strong>ä¸ºä»€ä¹ˆå¯ä»¥è½¬åŒ–å‘¢ï¼Ÿ</strong>å› ä¸ºç˜¦æ­»çš„éª†é©¼æ¯”é©¬å¤§ï¼Œã€Œæœ€å¤§å€¼ä¸­çš„æœ€å°å€¼ã€ä¹Ÿæ¯”ã€Œæœ€å°å€¼ä¸­çš„æœ€å¤§å€¼ã€æ¥å¾—å¤§ã€‚</p>
<p><strong>é‚£ä¹ˆå…ˆæ±‚æœ€å¤§å€¼å’Œå…ˆæ±‚æœ€å°å€¼æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</strong>å› ä¸ºè¿™æ ·æ›´å®¹æ˜“æ±‚è§£ã€‚æˆ‘ä»¬é€šè¿‡åå¯¼å…ˆæ±‚ <strong>L</strong> å…³äº ğ’˜ å’Œ ğ‘ æå°ï¼Œå†æ±‚ <strong>L</strong> çš„æå¤§ã€‚åˆ†åˆ«ä»¤ âˆ‚îˆ¸/âˆ‚w å’Œ âˆ‚îˆ¸/âˆ‚b ä¸ºé›¶å¯å¾—<br>$$<br>\frac{âˆ‚L}{âˆ‚w} = 0 â‡’ w = \sum_{i=1}^mğœ¶_iy_ix_i<br>$$</p>
<p>$$<br>\frac{âˆ‚L}{âˆ‚b} = 0 â‡’ \sum_{i=1}^mğœ¶_iy_i = 0<br>$$</p>
<p>ä»£å› <strong>L</strong> å¾—åˆ°SVMæ•°å­¦æè¿°çš„å¯¹å¶é—®é¢˜<br>$$<br>max_ğœ¶\quad \sum_{i=1}^mğœ¶_i - \frac{1}{2}\sum_{i=1}^m\sum_{j=1}^mğœ¶_iğœ¶_jy_iy_jx_i^Tx_j^T<br>$$</p>
<p>$$<br>s.t\quad\sum_{i=1}^mğœ¶_iy_i = 0,\quadğœ¶_iâ‰¥ 0,i =1,2,â€¦,m<br>$$</p>
<p>è§£å‡ºğœ¶åï¼Œæ±‚å‡ºwä¸bå³å¯å¾—åˆ°æ¨¡å‹<br>$$<br>\begin {align_} f(x) &amp; = w^T+b \\ &amp; = \sum_{i=1}^mğœ¶_iy_ix_i^Tx + b\end {align_}<br>$$<br>æ‰€ä»¥åªè¦æ±‚å‡ºäº†wå’Œbï¼Œå°†æµ‹è¯•æ•°æ®å¸¦å…¥ä¸Šé¢è¿™ä¸ªæ¨¡å‹ï¼Œå³å¯å¾—å‡ºé¢„æµ‹å€¼ã€‚</p>
<p>å®é™…ä¸Šï¼Œæ‰€æœ‰éæ”¯æŒå‘é‡çš„ğœ¶å€¼éƒ½ä¸ºé›¶ï¼Œ<strong>æœ€ç»ˆæ¨¡å‹åªä¸æ”¯æŒå‘é‡æœ‰å…³</strong>ã€‚å›å¿†ä¸€ä¸‹æˆ‘ä»¬çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°<br>$$<br>\max _{ğœ¶_iâ‰¥ 0}\quad Lï¼ˆw,b,ğœ¶) =\max_{ğœ¶_iâ‰¥ 0}\quad \frac{1}{2}||w||^2 + \color{red}{ğœ¶_i\sum_{i=1}^m(1-y_i(w^Tx_i+b))}<br>$$<br>å¦‚æœ x~i~ æ˜¯æ”¯æŒå‘é‡ï¼Œé‚£ä¹ˆçº¢è‰²æ ‡å‡ºéƒ¨åˆ†ä¸º0ï¼ˆå› ä¸ºæ”¯æŒå‘é‡å‡½æ•°é—´éš”ä¸º1ï¼‰ã€‚å¯¹äºéæ”¯æŒå‘é‡ï¼Œå‡½æ•°é—´éš”å¤§äº1ï¼Œé‚£ä¹ˆçº¢è‰²æ ‡å‡ºéƒ¨åˆ†å°†å°äº0ï¼Œä¸ºæ»¡è¶³æ•´ä¸ªå¼å­æœ€å¤§ï¼Œåªèƒ½ğœ¶~i~ ä¸º0ã€‚å› æ­¤æˆ‘ä»¬é¢„æµ‹çš„è¿‡ç¨‹åªéœ€è¦è®¡ç®—å°‘é‡å‘é‡çš„å†…ç§¯ï¼Œé€Ÿåº¦æ˜¯å¾ˆå¿«çš„ã€‚</p>
<h3 id="SMOç®—æ³•"><a href="#SMOç®—æ³•" class="headerlink" title="SMOç®—æ³•"></a>SMOç®—æ³•</h3><p>å¥½çš„ï¼Œæ¥ä¸‹æ¥é—®é¢˜å°±è½¬æ¢ä¸º<strong>å¦‚ä½•æ±‚è§£å¯¹å¶é—®é¢˜</strong>ã€‚1996å¹´ï¼ˆç«Ÿç„¶åœ¨æˆ‘å‡ºç”Ÿè¿™å¹´æäº‹æƒ…ğŸ™‚ï¼‰John Plattå‘å¸ƒäº†SMOï¼ˆSequntial Minimal Optimizationï¼‰ç®—æ³•ï¼Œå°†å¤§ä¼˜åŒ–é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªå°ä¼˜åŒ–é—®é¢˜æ±‚è§£ã€‚SMOçš„åŸºæœ¬æ€è·¯æ˜¯å…ˆå›ºå®šğœ¶~i~ä¹‹å¤–çš„æ‰€æœ‰å‚æ•°ï¼Œç„¶åæ±‚ğœ¶~i~ä¸Šçš„æå€¼ã€‚ç”±äºå­˜åœ¨çº¦æŸ $sum_{i=1}^mğœ¶_iy_i = 0$ ï¼Œè‹¥å›ºå®š ğœ¶~i~ ä¹‹å¤–çš„å…¶ä»–å˜é‡ï¼Œåˆ™ ğœ¶~i~ å¯ç”±å…¶ä»–å˜é‡å¯¼å‡ºã€‚äºæ˜¯SMOæ¯æ¬¡é€‰æ‹©ä¸¤ä¸ªå˜é‡ğœ¶~i~ å’Œ ğœ¶~j~ ï¼Œå¹¶å›ºå®šå…¶ä»–å‚æ•°ã€‚è¿™æ ·åœ¨å‚æ•°åˆå§‹åŒ–åï¼ŒSMOä¸æ–­æ‰§è¡Œå¦‚ä¸‹ä¸¤ä¸ªæ­¥éª¤ç›´è‡³æ”¶æ•›ï¼š</p>
<ul>
<li>é€‰å–ä¸€å¯¹éœ€è¦æ›´æ–°çš„å˜é‡ ğœ¶~i~ å’Œ ğœ¶~j~ ï¼›</li>
<li>å›ºå®š ğœ¶~i~ å’Œ ğœ¶~j~ ä»¥å¤–å‚æ•°ï¼Œæ±‚è§£è·å¾—æ›´æ–°åçš„ ğœ¶~i~ å’Œ ğœ¶~j~ </li>
</ul>
<p>å¥½çš„ï¼Œç†è§£SMOå®åœ¨æ˜¯æ— èƒ½ä¸ºåŠ›äº†ï¼Œæˆ‘ä»¬è¿›å…¥ä¸‹ä¸€ä¸ªè¯é¢˜ã€Œæ ¸å‡½æ•°ã€ã€‚</p>
<h3 id="æ ¸å‡½æ•°"><a href="#æ ¸å‡½æ•°" class="headerlink" title="æ ¸å‡½æ•°"></a>æ ¸å‡½æ•°</h3><p>ä¸Šé¢æˆ‘ä»¬è§£å†³äº†çº¿æ€§åˆ†ç±»é—®é¢˜ï¼Œä½†SVMè¿˜å¯ä»¥è§£å†³éçº¿æ€§çš„åˆ†ç±»é—®é¢˜ï¼Œè¿™å°±éœ€è¦å¼•å…¥ã€Œæ ¸å‡½æ•°ã€ï¼Œæ¥å°†æ•°æ®ä»ä¸€ä¸ªç‰¹å¾ç©ºé—´è½¬æ¢åˆ°å¦ä¸€ä¸ªç‰¹å¾ç©ºé—´ï¼Œåœ¨æ–°ç©ºé—´ä¸‹å†åˆ©ç”¨æ¨¡å‹å¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚</p>
<p><img src="/2017/10/22/machine-learning-in-action-note4/kernel.gif" alt="kernel"></p>
<p>å¾„å‘åŸºå‡½æ•°ï¼ˆradial bias functionï¼‰æ˜¯SVMå¸¸ç”¨çš„ä¸€ä¸ªæ ¸å‡½æ•°ï¼Œå…·ä½“å…¬å¼ä¸º<br>$$<br>k(x,y) = exp(\frac{-||x-y||^2}{2ğœ^2})<br>$$<br>å…¶ä¸­ ğœ æ˜¯ç”¨æˆ·å®šä¹‰çš„å‡½æ•°å€¼è·Œè½åˆ°0çš„é€Ÿåº¦å‚æ•°ã€‚</p>
<h3 id="SVMçš„ä¸€èˆ¬æµç¨‹"><a href="#SVMçš„ä¸€èˆ¬æµç¨‹" class="headerlink" title="SVMçš„ä¸€èˆ¬æµç¨‹"></a>SVMçš„ä¸€èˆ¬æµç¨‹</h3><ol>
<li>æ”¶é›†æ•°æ®ï¼šå¯ä»¥ä½¿ç”¨ä»»æ„æ–¹æ³•</li>
<li>å‡†å¤‡æ•°æ®ï¼šéœ€è¦æ•°å€¼å‹æ•°æ®</li>
<li>åˆ†ææ•°æ®ï¼šå¯è§†åŒ–åˆ†å‰²è¶…å¹³é¢æ˜¯å¾ˆæœ‰å¸®åŠ©çš„</li>
<li>è®­ç»ƒç®—æ³•ï¼šSVMç®—æ³•æœ€è€—æ—¶çš„åœ°æ–¹ã€‚è¯¥è¿‡ç¨‹ä¸»è¦å®ç°ä¸¤ä¸ªå‚æ•°è°ƒä¼˜</li>
<li>æµ‹è¯•ç®—æ³•ï¼šè®¡ç®—ååˆ†ç®€å•</li>
<li>ä½¿ç”¨ç®—æ³•ï¼šå‡ ä¹æ‰€æœ‰åˆ†ç±»é—®é¢˜éƒ½å¯ä»¥ç”¨SVMæ¥è§£å†³ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼ŒSVMæœ¬èº«æ˜¯ä¸€ä¸ªäºŒç±»åˆ†ç±»å™¨ï¼Œä½ éœ€è¦ä¿®æ”¹ä¸€äº›ä»£ç æ¥é€‚åº”å¤šåˆ†ç±»é—®é¢˜</li>
</ol>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>åœ¨ä½œè€…ç»™çš„æºç ä¸­ï¼Œæœ‰å¯è§†åŒ–æ•°æ®çš„éƒ¨åˆ†ï¼Œä¿®æ”¹äº†ä¸€ä¸‹ç”¨äºæµ‹è¯•ä¸åŒkå€¼rbfé€‰æ‹©çš„æ”¯æŒå‘é‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">xcord0 = []; ycord0 = []; xcord1 = []; ycord1 = []</div><div class="line">fig = plt.figure()</div><div class="line">ax = fig.add_subplot(<span class="number">111</span>)</div><div class="line">xcord0 = []; ycord0 = []; xcord1 = []; ycord1 = []</div><div class="line">fr = open(<span class="string">'testSetRBF.txt'</span>) <span class="comment"># generate data</span></div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> fr.readlines():</div><div class="line">    lineSplit = line.strip().split(<span class="string">'\t'</span>)</div><div class="line">    xPt = float(lineSplit[<span class="number">0</span>])</div><div class="line">    yPt = float(lineSplit[<span class="number">1</span>])</div><div class="line">    label = float(lineSplit[<span class="number">2</span>])</div><div class="line">    <span class="keyword">if</span> (label &lt; <span class="number">0</span>):</div><div class="line">        xcord0.append(xPt)</div><div class="line">        ycord0.append(yPt)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        xcord1.append(xPt)</div><div class="line">        ycord1.append(yPt)</div><div class="line">k1 = <span class="number">1.3</span> <span class="comment"># ä¿®æ”¹æµ‹è¯•</span></div><div class="line">sVs = svm.testRbf(k1)</div><div class="line">m = shape(sVs)[<span class="number">0</span>]</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(m):</div><div class="line">    x = sVs.A[i][<span class="number">0</span>]</div><div class="line">    y = sVs.A[i][<span class="number">1</span>]</div><div class="line">    circle = Circle((x,y), <span class="number">0.05</span>, facecolor=<span class="string">'none'</span>, edgecolor=(<span class="number">0</span>, <span class="number">0.8</span>, <span class="number">0.8</span>), linewidth=<span class="number">3</span>, alpha=<span class="number">0.5</span>)</div><div class="line">    ax.add_patch(circle)</div><div class="line">ax.scatter(xcord0, ycord0, marker=<span class="string">'s'</span>, s=<span class="number">30</span>)</div><div class="line">ax.scatter(xcord1, ycord1, marker=<span class="string">'o'</span>, s=<span class="number">30</span>, c=<span class="string">'red'</span>)</div><div class="line">plt.title(<span class="string">'RBF k1 = %f, %d Support Vectors'</span> %(k1, m))</div><div class="line">plt.show()</div><div class="line">fr.close()</div></pre></td></tr></table></figure>
<p><img src="/2017/10/22/machine-learning-in-action-note4/k_1.3.png" alt="k_1.3"></p>
<p><img src="/2017/10/22/machine-learning-in-action-note4/k_0.1.png" alt="k_0.1"></p>
<p>å¯ä»¥çœ‹å‡ºå‚æ•°å€¼è¶Šå°æ”¯æŒå‘é‡çš„èŒƒå›´è¶Šæ¨¡ç³Šï¼Œé€‰æ‹©åˆé€‚çš„å‚æ•°è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚</p>
<p><strong>å‚è€ƒé“¾æ¥</strong></p>
<ul>
<li><a href="https://www.zhihu.com/question/21094489" target="_blank" rel="external">https://www.zhihu.com/question/21094489</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/24638007" target="_blank" rel="external">é›¶åŸºç¡€å­¦SVMâ€”Support Vector Machine(ä¸€)</a> </li>
<li><a href="http://blog.pluskid.org/?p=632" target="_blank" rel="external">http://blog.pluskid.org/?p=632</a></li>
</ul>

  </div>
</article>
<% if(page.comments && theme.disqus.enabled){ %>
    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript><%= __('comments.no_js') %></noscript>
        </div>
    </div>
<% } %>


    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        <% for (var i in theme.nav) { %> 
          <li><a href="<%- url_for(theme.nav[i]) %>"><%= __('nav.'+i).replace("nav.", "") %></a></li>
        <% } %>
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <%- toc(page.content) %>
    </div>

    <div id="share-footer" style="display: none">
      <%- partial('_partial/post/share', { icon_class_name: 'fa-lg' }) %>
    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> <%= __('post.mobile.menu') %></a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> <%= __('post.mobile.toc') %></a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> <%= __('post.mobile.share') %></a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> <%= __('post.mobile.back_to_top') %></a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    <%= __('footer.copyright') %> &copy; <%= new Date().getFullYear() %> <%= config.author || config.title %>
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <% for (var i in theme.nav) { %> 
          <li><a href="<%- url_for(theme.nav[i]) %>"><%= __('nav.'+i).replace("nav.", "") %></a></li>
        <% } %>
      </ul>
    </nav>
  </div>
</footer>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
<!-- styles -->
<%- css('lib/font-awesome/css/fontawesome-all.min') %>
<%- css('lib/justified-gallery/css/justifiedGallery.min.css') %>

<!-- jquery -->
<%- js('lib/jquery/jquery.min') %>
<%- js('lib/justified-gallery/js/jquery.justifiedGallery.min.js') %>
<%- js('js/main') %>
<!-- particles -->
<%- js('lib/particles/particles.min') %>
<script type="text/javascript">
    particlesJS('particles-js', {
        "particles": {
            "number": {
            "value": 60,
            "density": {
                "enable": true,
                "value_area": 1200
            }
            },
            "color": {
            "value": "#d25e5e"
            },
            "shape": {
            "type": "circle",
            "stroke": {
                "width": 0,
                "color": "#000000"
            },
            "polygon": {
                "nb_sides": 3
            },
            "image": {
                "src": "img/github.svg",
                "width": 100,
                "height": 100
            }
            },
            "opacity": {
            "value": 0.35,
            "random": false,
            "anim": {
                "enable": false,
                "speed": 1,
                "opacity_min": 0.1,
                "sync": false
            }
            },
            "size": {
            "value": 2,
            "random": true,
            "anim": {
                "enable": false,
                "speed": 40,
                "size_min": 0.1,
                "sync": false
            }
            },
            "line_linked": {
            "enable": true,
            "distance": 150,
            "color": "#e88181",
            "opacity": 0.352750653390415,
            "width": 0.9620472365193136
            },
            "move": {
            "enable": true,
            "speed": 6,
            "direction": "none",
            "random": false,
            "straight": false,
            "out_mode": "out",
            "bounce": false,
            "attract": {
                "enable": false,
                "rotateX": 600,
                "rotateY": 1200
            }
            }
        },
        "interactivity": {
            "detect_on": "canvas",
            "events": {
            "onhover": {
                "enable": true,
                "mode": "repulse"
            },
            "onclick": {
                "enable": true,
                "mode": "push"
            },
            "resize": true
            },
            "modes": {
            "grab": {
                "distance": 400,
                "line_linked": {
                "opacity": 1
                }
            },
            "bubble": {
                "distance": 400,
                "size": 40,
                "duration": 2,
                "opacity": 8,
                "speed": 3
            },
            "repulse": {
                "distance": 200,
                "duration": 0.4
            },
            "push": {
                "particles_nb": 4
            },
            "remove": {
                "particles_nb": 2
            }
            }
        },
        "retina_detect": true
        });
</script>
<!-- search -->
<% if (config.search && page.search){ %>
  <%- js('js/search.js') %>
  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input");
    var $resultArea = $("#search-result");

    inputArea.onfocus = function() {
      var search_path = "<%= config.search.path %>";
      if (search_path.length == 0) {
        search_path = "search.xml";
      }
      var path = "<%= config.root %>" + search_path;
      searchFunc(path, 'search-input', 'search-result');
    }

    inputArea.onkeydown = function(){
        if(event.keyCode==13){
            return false
        }
    }

    $resultArea.bind("DOMNodeRemoved DOMNodeInserted", function(e) {
        if (!$(e.target).text()) {
            $(".search-no-result").show(200);
        } else {
            $(".search-no-result").hide();
        }
    })
  </script>
<% } %>
<!-- Google Analytics -->
<% if (theme.google_analytics.enabled && theme.google_analytics.id){ %>
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', '<%= theme.google_analytics.id %>', 'auto');
        ga('send', 'pageview');
    </script>
<% } %>
<!-- Baidu Analytics -->
<% if (theme.baidu_analytics.enabled && theme.baidu_analytics.id){ %>
    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?<%= theme.baidu_analytics.id %>";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
<% } %>
<!-- Disqus Comments -->
<% if (theme.disqus.enabled && theme.disqus.shortname){ %>
    <script type="text/javascript">
        var disqus_shortname = '<%= theme.disqus.shortname %>';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/<% if (page.comments){ %>embed.js<% } else { %>count.js<% } %>';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>
<% } %>

